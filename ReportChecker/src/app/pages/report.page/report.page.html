<div class="container">
  <div class="header-container">
    <div class="title-container">
      <h2>{{ (selectedReport$ | async)?.name }}</h2>
      @if (isProgress$ | async) {
        <div class="progress-container">
          <tui-loader/>
          <div>Поиск ошибок...</div>
        </div>
      }
    </div>

    <button tuiIconButton iconStart="@tui.trash" appearance="negative" (click)="deleteReport()"></button>

    <div class="upload-new-version-container">
      <label>Загрузить новую версию:</label>
      <div class="file-uploader-container">
        <app-file-uploader class="file-uploader" [formControl]="control"/>
        <button tuiIconButton iconStart="@tui.check" appearance="positive" (click)="createCheck()"
                [loading]="loading | async" [disabled]="!(this.control.valueChanges | async)"></button>
      </div>
    </div>

  </div>
  <tui-accordion>
    @for (issue of issues$ | async; track issue.id) {
      <ng-container>
        <button tuiAccordion class="issue-header">
          <app-issue-header [issue]="issue" class="header-content"/>
        </button>
        <tui-expand>
          <app-comments [issue]="issue"/>
        </tui-expand>
      </ng-container>
    }
  </tui-accordion>

  <tui-accordion>
    @for (issue of closedIssues$ | async; track issue.id) {
      <ng-container>
        <button tuiAccordion class="issue-header">
          <app-issue-header [issue]="issue" class="header-content"/>
        </button>
        <tui-expand>
          <app-comments [issue]="issue"/>
        </tui-expand>
      </ng-container>
    }
  </tui-accordion>
</div>
